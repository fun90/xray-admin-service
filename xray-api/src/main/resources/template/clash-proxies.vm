#if($target == "clash3")
proxy-providers:
  duoyu:
    type: http
    path: ./proxies.yaml
    url: $proxiesUrl
    interval: 3600
    health-check:
      enable: true
      url: http://onedrive.live.com
      interval: 300
#end

#set($supportSevers = [])
#foreach($item in $servers)
  #if($inclueItems.contains($item.protocol))
    #set($result = $supportSevers.add($item))
  #end
#end
#set($delimiter = $lineSeparator)
#set($serverNames = "")
#foreach($item in $supportSevers)
  #if($inclueItems.contains($item.protocol))
    #set($serverNames = "$serverNames      - $item.serverName$delimiter")
  #end
#end
#if ($test)
#set($ruleList = [
  {"name":"MyReject", "group":"REJECT"},
  {"name":"MyDirect", "group":"DIRECT"},
  {"name":"MyProxy", "group":"🔰 代理"},
  {"name":"AdvertisingLite", "group":"🚫 广告"},
  {"name":"AdvertisingLiteDomain", "group":"🚫 广告", "behavior": "classical"},
  {"name":"OpenAI", "group":"🐳 OpenAI", "proxy":true},
  {"name":"Amazon", "group":"🛍 亚马逊", "proxy":true},
  {"name":"PayPal", "group":"💰 PayPal", "proxy":true},
  {"name":"YouTube", "group":"🏖 YouTube", "proxy":true},
  {"name":"Microsoft", "group":"👔️ 微软", "proxy":true},
  {"name":"iCloud", "group":"☁️ iCloud"},
  {"name":"Apple", "group":"🍎 苹果"},
  {"name":"Whatsapp", "group":"🐚 Whatsapp", "proxy":true},
  {"name":"TikTok", "group":"👙 TikTok", "proxy":true}
])
#else
#set($ruleList = [
  {"name":"MyReject", "group":"REJECT"},
  {"name":"MyDirect", "group":"DIRECT"},
  {"name":"MyProxy", "group":"🔰 代理"},
  {"name":"OpenAI", "group":"🐳 OpenAI", "proxy":true},
  {"name":"Amazon", "group":"🛍 亚马逊", "proxy":true},
  {"name":"PayPal", "group":"💰 PayPal", "proxy":true},
  {"name":"YouTube", "group":"🏖 YouTube", "proxy":true},
  {"name":"Microsoft", "group":"👔️ 微软", "proxy":true},
  {"name":"iCloud", "group":"☁️ iCloud"},
  {"name":"Apple", "group":"🍎 苹果"},
  {"name":"Whatsapp", "group":"🐚 Whatsapp", "proxy":true},
  {"name":"TikTok", "group":"👙 TikTok", "proxy":true}
])
#end

#if ($whitelist)
  #set($tmp = $ruleList.add({"name":"CN", "group":"🎯 直连"}))
#else
  #set($tmp = $ruleList.add({"name":"Proxy", "group":"🔰 代理"}))
#end
proxy-groups:
  - name: 🔰 代理
    type: select
    proxies:
      - ♻️ 自动选择
      - 🎯 直连
#if($target == "clash3")
    use:
      - duoyu
#else
$serverNames
#end


  - name: ♻️ 自动选择
    type: url-test
    url: http://www.gstatic.com/generate_204
    interval: 300
    proxies:
#if($target == "clash3")
    use:
      - duoyu
#else
$serverNames
#end

#foreach( $rule in $ruleList)
#if($rule.proxy)
  - name: $rule.group
    type: select
    proxies:
      - 🔰 代理
      - ♻️ 自动选择
#if($target == "clash3")
    use:
      - duoyu
#else
$serverNames
#end
#end#end

  - name: ☁️ iCloud
    type: select
    proxies:
      - 🎯 直连
      - 🔰 代理
      - ♻️ 自动选择
#if($target == "clash3")
    use:
      - duoyu
#else
$serverNames
#end

  - name: 🍎 苹果
    type: select
    proxies:
      - 🎯 直连
      - 🔰 代理
      - ♻️ 自动选择
#if($target == "clash3")
    use:
      - duoyu
#else
$serverNames
#end

  - name: 🚫 广告
    type: select
    proxies:
      - REJECT
      - DIRECT

  - name: 🎯 直连
    type: select
    proxies:
      - DIRECT

  - name: ⛳️ 其他
    type: select
    proxies:
#if ($whitelist == true)
      - 🔰 代理
      - ♻️ 自动选择
      - 🎯 直连
#if($target == "clash3")
    use:
      - duoyu
#else
$serverNames
#end
#else
      - 🎯 直连
      - 🔰 代理
      - ♻️ 自动选择
#if($target == "clash3")
    use:
      - duoyu
#else
$serverNames
#end
#end